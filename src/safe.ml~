open Env



let print_value = function
  |Int x -> print_int x
  |_ -> raise (Invalid_argument "Cannot print a function")
;;

let print_identifier = function
  |s -> print_string s
;;

let penv_item identifier v =
  print_identifier identifier; print_string " = " ; print_value v ; ps "; ";;

let print_env env = ps "{"; Environnement.iter penv_item env; ps "} \n";;

let safe_add e1 e2 = match e1,e2 with
  |Int x, Int y -> Int(x + y)
  |_ -> raise (Invalid_argument "Cannot sum a function")
;;

let safe_mult e1 e2 = match e1,e2 with
  |Int x, Int y ->Int( x * y)
  |_ -> raise (Invalid_argument "Cannot mult a function")
;;

let safe_sou e1 e2 = match e1,e2 with
  |Int x, Int y -> Int (x - y)
  |_ -> raise (Invalid_argument "Cannot sub a function")
;;

let safe_div e1 e2 = match e1,e2 with
  |Int x, Int y when y <> 0 ->Int( x /  y)
  |_, Int y when y = 0 -> raise (Division_by_zero)
  |_,_ -> raise (Invalid_argument "Cannot sum a function")
;;

let safe_op e1 op e2 = match e1,e2 with
  |Int x, Int y -> op x y
  |_,_ -> raise (Invalid_argument "I can't succeed")
                           
